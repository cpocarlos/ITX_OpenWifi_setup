<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenWiFi Onboarding</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
            background-color: #ffffff;
            color: #000;
            text-align: center;
            padding-top: 40px;
        }
        .container { max-width: 500px; padding: 20px; }
        .logo { height: 35px; margin-bottom: 30px; }
        h1 { font-size: 1.1rem; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 15px; }
        p { font-size: 0.9rem; color: #555; }
        
        .btn-zara {
            background-color: #000; color: #fff; border-radius: 0;
            padding: 14px; font-weight: bold; text-transform: uppercase;
            width: 100%; margin-bottom: 20px; border: 1px solid #000;
            text-decoration: none; display: inline-block;
        }
        .btn-zara:hover { background-color: #333; color: #fff; }
        
        .btn-outline-zara {
            background-color: transparent; color: #000; border-radius: 0;
            padding: 10px; text-transform: uppercase; width: 100%;
            border: 1px solid #000; margin-top: 10px; text-decoration: none; display: inline-block;
            font-size: 0.8rem; font-weight: bold;
        }

        .instruction-step { display: none; margin-top: 25px; border-top: 1px solid #eee; padding-top: 25px; }
        
        /* CORRECCIÓN DE IMÁGENES CORTADAS */
        .carousel-item {
            height: 350px; 
            background-color: #fff;
            border-radius: 10px;
        }
        .carousel-item img { 
            width: 100%;
            height: 100%;
            object-fit: contain; /* Mantiene la proporción sin recortar */
        }
        
        #loading-area { margin-top: 50px; }
    </style>
</head>
<body>

<div class="container">
    
    <div id="loading-area">
        <h1>Detectando dispositivo</h1>
        <div class="spinner-border text-dark mt-3" role="status"></div>
    </div>

    <div id="main-content" style="display:none;">
        <h1 id="device-title">Configuración Wi-Fi</h1>
        <p id="device-msg">Iniciando descarga de perfil seguro...</p>
        
        <a id="download-btn" href="#" class="btn btn-zara" target="_blank">Descargar Perfil Manualmente</a>

        <div id="ios-guide" class="instruction-step">
            <h3>Instrucciones iPhone / iPad:</h3>
            <p class="small">1. Pulse <b>Permitir</b> en el aviso.<br>
            2. Pulse el botón inferior para abrir Ajustes.<br>
            3. Entre en <b>Perfil descargado</b> e Instalar.</p>
            <a href="App-prefs:root=General&path=ManagedConfigurationList" class="btn btn-outline-zara">Abrir Ajustes de Perfiles</a>
            
            <div id="carouselIOS" class="carousel slide mt-4" data-bs-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active"><img src="imgs/ios-1.png" class="d-block"></div>
                    <div class="carousel-item"><img src="imgs/ios-2.png" class="d-block"></div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselIOS" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselIOS" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                </button>
            </div>
        </div>

        <div id="android-guide" class="instruction-step">
            <h3>Instrucciones Android:</h3>
            <p class="small">La descarga ha comenzado. Abra el archivo y seleccione "Guardar".</p>
            <div id="carouselAndroid" class="carousel slide mt-4" data-bs-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active"><img src="imgs/android-1.jpg" class="d-block"></div>
                </div>
            </div>
        </div>

        <div id="windows-guide" class="instruction-step">
            <h3>Instrucciones Windows:</h3>
            <p class="small">Se abrirá una ventana de configuración nativa de Windows.</p>
            <div id="carouselWindows" class="carousel slide mt-4" data-bs-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active"><img src="imgs/windows-1.png" class="d-block"></div>
                    <div class="carousel-item"><img src="imgs/windows-2.png" class="d-block"></div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselWindows" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselWindows" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                </button>
            </div>
        </div>

        <div id="macos-guide" class="instruction-step">
            <h3>Instrucciones Mac:</h3>
            <a href="x-apple.systempreferences:com.apple.preferences.configurationprofiles" class="btn btn-outline-zara">Abrir Preferencias de Perfiles</a>
        </div>
    </div>
</div>

<script>
    const URL_BASE    = "https://api.inditex.com/openroamin/openroaming/v1/certificate?cadena=zara";
    const URL_DEFAULT = "https://splash.dnaspaces.eu/s/6881/Home";

    function getPlatform() {
        const ua = navigator.userAgent || navigator.vendor || window.opera;
        if (/iPad|iPhone|iPod/.test(ua) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1)) return 'IOS';
        if (/android/i.test(ua)) return 'ANDROID';
        if (/Macintosh|MacIntel|MacPPC|Mac68K/.test(ua)) return 'MACOS';
        if (/Win/i.test(ua)) return 'WINDOWS';
        return 'UNKNOWN';
    }

    (function init() {
        const platform = getPlatform();
        const dlBtn = document.getElementById('download-btn');
        const title = document.getElementById('device-title');
        const loader = document.getElementById('loading-area');
        const main = document.getElementById('main-content');
        
        let finalUrl = URL_DEFAULT;
        if (platform === 'IOS' || platform === 'MACOS') finalUrl = URL_BASE + "&platform=ios";
        if (platform === 'ANDROID') finalUrl = URL_BASE + "&platform=android";
        if (platform === 'WINDOWS') finalUrl = "ms-settings:wifi-provisioning?uri=" + encodeURIComponent(URL_BASE + "&platform=windows");

        dlBtn.href = finalUrl;

        setTimeout(() => {
            loader.style.display = 'none';
            main.style.display = 'block';

            if (platform === 'IOS') {
                title.innerText = "Wi-Fi para iPhone";
                document.getElementById('ios-guide').style.display = 'block';
            } 
            else if (platform === 'ANDROID') {
                title.innerText = "Wi-Fi para Android";
                document.getElementById('android-guide').style.display = 'block';
                window.location.href = finalUrl;
            }
            else if (platform === 'WINDOWS') {
                title.innerText = "Wi-Fi para Windows";
                document.getElementById('windows-guide').style.display = 'block';
                window.location.href = finalUrl;
            }
            else if (platform === 'MACOS') {
                title.innerText = "Wi-Fi para Mac";
                document.getElementById('macos-guide').style.display = 'block';
                window.location.href = finalUrl;
            }
            else {
                window.location.replace(URL_DEFAULT);
            }
        }, 1000);
    })();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
